<!DOCTYPE html>
<html lang="en-US">
    <head>

        <meta charset="UTF-8">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2C44LTKBE1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2C44LTKBE1');
</script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
            <title>Statistical Mechanics</title>
    
        <!-- Meta tags -->
        
        <meta name="keywords" content="Biophysics, chemistry, statistical mechanics, Boltzmann, heat capacity">
        <meta name="author" content="John Della Rosa" >
        <meta name="description" content="In this chapter, the basics of statistical mechanics are covered, such as Boltzmann distributions and Gibbs Free Energy.">
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
        <link rel="apple-touch-icon" sizes="180x180" href="https://johndellarosa.github.io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://johndellarosa.github.io/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://johndellarosa.github.io/favicon-16x16.png">
        <link rel="manifest" href="https://johndellarosa.github.io/site.webmanifest">
            
        <link rel="stylesheet" href="https://johndellarosa.github.io/style.css"> 
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
      

        <script src="../../math.js" type="text/javascript"></script>

    </head>
    <body>
        <div class="navbar">
            <b style="margin-right:10px">John Della Rosa</b>| 
            <a href="https://johndellarosa.github.io/index.html">Home</a>|
            <a href="https://johndellarosa.github.io/resume.html">Resume</a>
            <!-- <a href="./index.html#education">Education</a>
            <a href="./index.html#experience">Experience</a>
            <a href="./index.html#skills">Skills</a> -->
            |
            <a href="https://johndellarosa.github.io/biography.html">About</a>|
            <a href="https://johndellarosa.github.io/projects.html">Projects</a>|
            <a href="https://johndellarosa.github.io/Miscellaneous.html">Misc</a>|
            <a href="https://www.linkedin.com/in/johndellarosa/" target="_blank">Linkedin</a>|
            <a href="https://github.com/johndellarosa" target="_blank">Github</a>|
            <a href="https://play.google.com/store/apps/developer?id=JohnDellaRosa" target="_blank">Google Play</a>|
            <a href="https://apps.apple.com/us/developer/john-della-rosa/id1684177615" target="_blank">Apple Store</a>
        
        </div>
        <h2><a href= "Table-of-Contents.html">Biophysical Chemistry Textbook (Work in Progress)</a></h2>

<h3>by John Della Rosa</h3>
        <div id="text-contents" style="width:90%; margin:auto">
            <div id="Statistical-Mechanics">
                <h1>Statistical Mechanics</h1>
                <h2>Introduction</h2>
                <h3>Refresher on Microstates and Macrostates</h3>

                <h2>Entropy</h2>
                <h3>Boltzmann Definition of Entropy</h3>

                <h2>Boltzmann Distribution</h2>
                <h3>Equilibrium</h3>
                We previously went over microstates in the probability chapter. 
                A system at equilibrium has states that are populated proportional to 

                $$p(a)= \frac{e^{-\frac{E_a}{k_BT}}}{Q}$$
                where p(a) is the population of a microstate a, \(E_a\) is the energy level of state a, \(k_B\) is Boltzmann's constant (\(1.38\times 10^{-23}\)J/K), T is temperature, and Q is a normalization factor.
                Sometimes we will instead write the denominator for the exponent as 
                $$\beta = \frac{1}{k_BT}$$


                We can also describe the ratio of how populated two microstates are by

                $$\frac{p(a)}{p(b)}=e^{-\frac{E_a-E_b}{k_BT}}$$

                We can write this without a proportionality as the normalization factor cancels out.
                This implies that two microstates with the energy are equally populated at equilibirium. 
                It also states that microstates at lower energy will be more populated than high energy microstates. 
                Why is the Boltzmann distribution what we observe for a system? The derivation is beyond the scope of this text, but the Boltzmann distribution maximizes <b>total</b> entropy (not system entropy). 
                <br><br>
                <h3>Multiplicity</h3>
                What the Boltzmann distribution gave us was a way to relate populations of <b>microstates</b>, but what about states? 

                Let us consider a two level system.

                <ol>
                    <li>1 ground state (G) - Energy=0</li>
                    <li>2 excited states (A and B) - Energy=E</li>
                </ol>



                From the Boltzmann distribution we know

                $$\frac{p(A)}{p(G)}=\frac{e^{-\frac{E}{k_BT}}}{Q}$$
                and also 
                $$\frac{p(B)}{p(G)}=\frac{e^{-\frac{E}{k_BT}}}{Q}$$

                The proportion of molecules in the excited state would thus be given by

                $$\frac{p(E)}{p(G)}=\frac{\nu_E}{\nu_G}e^{-\frac{E}{k_BT}}=e^{-\frac{E}{k_BT}}2$$
                where \(nu_i\) is the degeneracy (amount of microstates within the state) for state i.
                In this case, \(\nu_E=2\) and \(\nu_G=1\)

                In order to calculate Q

                $$Q=\sum e^{-\frac{E_{i}}{k_BT}}$$

                One interpretation of Q is that it is the number of thermally accessible states at a given temperature. 
                


                Below is a graph of a 3-level system where each state has degeneracy=1 and the energy levels are \(0K_B\), \(500K_B\), \(1000K_B\)
                <img src="BoltzmannGraph.png" alt="Boltzmann Distribution Graph" style="margin:auto; display: block;  width:clamp(400px,50vw, 1000px)"/>
                Python code:
                <code style="margin: auto; width: 50%;"><pre>
energy_levels = [0, 500, 1000] # energy levels in multiples of k_B
def GetBoltzmann(E,T):
    # k_B = 1.38e-23
    k_B = 1
    return np.exp(-E/(k_B*T))

def GetQ(array,T):
    accum = 0
    for item in array:
        accum += GetBoltzmann(item,T)
    return [GetBoltzmann(E,T) for E in array]/accum
plt.figure(figsize=(14,8))
width = 20
plt.bar([i-width/2 for i in energy_levels],
        GetQ(energy_levels, 300),width=20)
plt.bar([i+width/2 for i in energy_levels],
        GetQ(energy_levels, 500),width=20)
plt.xlabel("Energy Level (E/k_B)")
plt.ylabel("Population fraction")
plt.xticks([100*i for i in range(0,11)])
plt.title("Boltzmann Distribution T=300K and T=500K")
plt.legend(["300K","500K"])
plt.show()</pre>
                </code>
                <h4>Maxwell-Boltzmann Distribution</h4>
                So we've seen that the Boltzmann distribution makes lower energy microstates more populated. 
                Does this mean that lower energy states are always more populated? 
                The answer is not necessarily; higher energy macrostates can be more populated if there are more microstates than there are in the lower energy levels and you are at a sufficient temperature. 
                One example is how speed for molecules are distributed, called the Maxwell-Boltzmann distribution. 

                The multiplicity for the number of microstates for a given speed is proportional to the square of the speed, as it is like the surface area of a sphere of radius v, where v is the speed.

                $$f(v)=(\frac{m}{2\pi k_BT})^{3/2}\times(4\pi v^2)\times\exp(-\frac{m}{2k_BT}v^2)$$
                While the distribution may not initially appear like a Boltzmann distribution, this is because it is parameterized in terms of speed. 
                By using the kinetic energy equation
                $$K=\frac{1}{2}mv^2$$
                You recover the familiar decaying exponential.
                The resulting distribution is shown below.

                <img src="MaxwellBoltzmannGraph.png" alt="Maxwell-Boltzmann Graph for Argon" style="margin:auto; display: block;  width:clamp(400px,50vw, 1000px)"/>
                Python code:
                <code style="margin: auto; width: 50%;"><pre>
def Maxwell_Boltzmann(x,T, m):
    if type(x) == np.array or type(x) == list:
        return np.array([Maxwell_Boltzmann(i,T,m) for i in x])
    k_B = 1.38e-23
    return (m/(2*np.pi*k_B*T))**(3/2)*(4*np.pi*x**2)*np.exp(-m*(x**2)/(2*k_B*T))

v_array = [i for i in range(0,1500)]
m_argon = 1.6605e-27*39.89
plt.figure(figsize=(14,8))
plt.plot(v_array,Maxwell_Boltzmann(v_array,T=200,m=m_argon))
plt.plot(v_array,Maxwell_Boltzmann(v_array,T=300,m=m_argon))
plt.plot(v_array,Maxwell_Boltzmann(v_array,T=500,m=m_argon))
plt.title("Maxwell-Boltzmann Plots for Argon")
plt.xlabel("Speed (m/s)")
plt.ylabel(f"Probability Density")
plt.legend(['200K','300K','500K'])
plt.show()</pre>
                </code>

                <h3>
                    Heat Capacity
                </h3>
                In order to calculate the average energy of the system, we can take the expected value of the energy

                $$\lt E \gt=\sum_{\nu}E_{\nu}P(\nu)$$

                It can be shown that 

                $$\lt E \gt = -\frac{\partial \ln Q}{\partial B}$$

                By taking the second derivative of Q with respect to beta, it can be further shown that

                $$\text{Var}(E)=K_BT^2\frac{\partial \lt E \gt}{\partial T}$$

                <h3>Concentration and Its Effect</h3>

                $$\Delta G = \Delta G^0 + RT \ln(Q)$$
                where Q is the current concentration for the equilibrium K expression. 

                <br><br>
                Imagine a reaction of an ion going from one area to another with the two concentrations being different.

                $$Ca^{2+}_{left}\rightleftharpoons Ca^{2+}_{right}$$

                Since there is no actual chemical reaction, \(\Delta G^0=0\)

                However, since the concentrations are different

                $$Q=\frac{[Ca^{2+}_{right}]}{[Ca^{2+}_{right}]}$$

                <h3>Equilibrium and Gibbs</h3>

                We are given \(\Delta G^0=-RT \ln(K)\)

                Equilibirium is reached when dG=0.

                $$0=-RT\ln(K)+RT\ln(Q)$$

                Since log is a bijective function, we can conclude that equilibrium is reached when

                $$Q=K$$

                <!-- <h2>Osmosis</h2> -->
                


            </div>

        </div>
</body>
</html>
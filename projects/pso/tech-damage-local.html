<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2C44LTKBE1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2C44LTKBE1');
</script>
        <title>PSO Tech Damage Calculator</title>

    <!-- Meta tags -->
    
    <meta name="keywords" content="PSO, tech damage calculator">
    <meta name="author" content="John Della Rosa" >
    <meta name="description" content="PSO tech damage calculator">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon" sizes="180x180" href="https://johndellarosa.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://johndellarosa.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://johndellarosa.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://johndellarosa.github.io//site.webmanifest">
    <link rel="canonical" href="https://johndellarosa.github.io/projects/pso/tech-damage">     
    <link rel="stylesheet" href="https://johndellarosa.github.io/style.css">    
    <script
    src="https://unpkg.com/react@17/umd/react.development.js"
    crossorigin
  ></script>
  <script
    src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"
    crossorigin
  ></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script type="text/javascript" src="./pso-functions.js"></script>
</head>
<body>
    <div class="navbar">
        <b style="margin-right:10px">John Della Rosa</b>| 
        <a href="https://johndellarosa.github.io/index.html">Home</a>|
        <a href="https://johndellarosa.github.io/resume.html">Resume</a>
        <!-- <a href="./index.html#education">Education</a>
        <a href="./index.html#experience">Experience</a>
        <a href="./index.html#skills">Skills</a> -->
        |
        <a href="https://johndellarosa.github.io/biography.html"><u>About</u></a>|
        <a href="https://johndellarosa.github.io/projects.html">Projects</a>|
        <a href="https://johndellarosa.github.io/miscellaneous.html">Misc</a>|
        <a href="https://www.linkedin.com/in/johndellarosa/" target="_blank">Linkedin</a>|
        <a href="https://github.com/johndellarosa" target="_blank">Github</a>|
        <a href="https://play.google.com/store/apps/developer?id=JohnDellaRosa" target="_blank">Google Play</a>|
        <a href="https://apps.apple.com/us/developer/john-della-rosa/id1684177615" target="_blank">Apple Store</a>
    
    </div> 

    <div id="data-table"></div>

    <script>
        // Path to your local Excel file relative to the location of this HTML file
        const excelUrl = './PSO_Enemy.xlsx';

        // Define a global variable to hold the JSON data
        let globalJsonData = null;

        function loadExcelFile(url, callback) {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.responseType = 'arraybuffer';

            xhr.onload = function(e) {
                if (xhr.status === 200) {
                    // Use SheetJS to read the buffer
                    const arrayBuffer = xhr.response;
                    const workbook = XLSX.read(arrayBuffer, { type: 'buffer' });
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const json = XLSX.utils.sheet_to_json(worksheet, { raw: false ,header:1});
                    
                    // Assign the JSON data to the global variable
                    globalJsonData = json;
                    
                    // Call the callback function if provided
                    if(callback) {
                        callback(json);
                    }
                } else {
                    console.error('Error loading file');
                }
            };

            xhr.onerror = function() {
                console.error('Error loading file');
            };

            xhr.send();
        }

        // Usage example:
        loadExcelFile('./PSO_Enemy.xlsx', function(jsonData) {
            // This callback function gets executed after the JSON data is loaded
            // Now you can use jsonData here
            console.log('Data loaded:', jsonData);

            // If you need to perform operations on the data, you would typically call those functions from here.
            processData(jsonData);

            return jsonData;
        });

        function processData(data) {
            // Create a table element
            let table = document.createElement('table');
            table.style.width = '100%';
            table.setAttribute('border', '1');

            // Generate table headers
            let thead = document.createElement('thead');
            let headerRow = document.createElement('tr');
            
            // Assuming first row of data contains headers
            let headers = data[0];
            headers.forEach(header => {
                let th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Generate table body
            let tbody = document.createElement('tbody');
            data.slice(1).forEach(row => { // Skip the header row
                let tr = document.createElement('tr');
                row.forEach(cell => {
                    let td = document.createElement('td');
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);

            // Append the table to the div with id="data-table"
            document.getElementById('data-table').appendChild(table);
        }

        // Later in the code, if you need to access the JSON data outside the callback, you can check if it has been loaded
        if (globalJsonData !== null) {
            // Use globalJsonData here
            console.log(globalJsonData);
        } else {
            console.log('Data is not loaded yet.');
        }


        // Load the Excel file
        const enemy_stats = loadExcelFile(excelUrl);


        

    </script>


    

    <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
            content.style.display = "none";
            } else {
            content.style.display = "block";
            }
        });
        } 
        </script>
</body>
</html>
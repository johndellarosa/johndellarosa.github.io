<!DOCTYPE html>
<html lang="en-US">
    <head>

        <meta charset="UTF-8">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2C44LTKBE1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2C44LTKBE1');
</script>
<script src="mixture-funcs.js"></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
            <title>Mixture Distributions</title>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <!-- Meta tags -->
        
        <meta name="keywords" content="Mixture distribution">
        <meta name="author" content="John Della Rosa" >
        <meta name="description" content="Introduction to mixture distributions.">
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
        <link rel="apple-touch-icon" sizes="180x180" href="https://johndellarosa.github.io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://johndellarosa.github.io/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://johndellarosa.github.io/favicon-16x16.png">
        <link rel="manifest" href="https://johndellarosa.github.io/site.webmanifest">
        <link rel="canonical" href="https://johndellarosa.github.io/projects/distribution-book/mixture-distributions"/>    
        <link rel="stylesheet" href="https://johndellarosa.github.io/style.css"> 
<!-- 
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
      

        <script src="../../math.js" type="text/javascript"></script> -->
        <style>
            body {
              font-family: Arial, sans-serif;
              /* background-color: #f5f5f5; */
            }
            
            .container {
              max-width: 1800px;
              width:100%;
              margin: 50px auto;
              padding: 20px;
              background-color: white;
              border-radius: 8px;
              box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
              display: flex;
              flex-direction: column;
              align-items: center;
            }
            
            .input-section, .output-section {
              width: 100%;
              display: flex;
              flex-direction: column;
              align-items: center;
            }
            
            .input-group, #dataPointsList {
              width: 100%;
              margin-bottom: 20px;
              max-width: 500px;
              margin: 0% auto;
              align-items: center;
            }
            
            #dataPointsList button {
                padding:15px;
                margin: 5px;
                background-color: #6CB4EE;
                border-radius: 10px;
            }
            
            #dataPointsList button:hover{
            
              background-color: #6699CC
            
            }

            code {
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            padding: 10px;
            display: block;
            white-space: pre-wrap; /* Ensure code wraps correctly */
            font-family: monospace;
            line-height: 1.5;
        }

            #mixtureChart {
              max-width: 900px;
              /* width:100%; */
            width: 80vw;
            max-height: 50vh;
              /* height: 20%; */
              /* height: 600px; */
              /* max-height: 1000px; */
            }
            
            
            .input-group label {
              display: block;
              font-weight: bold;
              margin-bottom: 5px;
            }
            
            .input-group input, .input-group select {
              width: 100%;
              padding: 8px;
              font-size: 14px;
              margin-bottom: 5px;
              border: 1px solid #ccc;
              border-radius: 4px;
            
            }
            
            button {
              padding: 10px 20px;
              font-size: 16px;
              background-color: #28a745;
              color: white;
              border: none;
              border-radius: 4px;
              cursor: pointer;
              transition: background-color 0.3s ease;
            
            }
            
            button:hover {
              background-color: #218838;
            }
            
            input, select {
                margin-bottom:10px;
            }
            
            #chart {
              max-width: 900px;
              /* width:100%; */
            width: 80vw;
            max-height: 50vh;
              /* height: 20%; */
              /* height: 600px; */
              /* max-height: 1000px; */
            }
            
            .output-section {
              display: none;
              width: 100%;
              text-align: center;
            }
            
            h2 {
              margin-bottom: 20px;
            }
            
            h1 {
              text-align: center;
            }
            
            /* Smaller screens (e.g., smartphones) */
            @media (max-width: 600px) {
                .container {
                    width: 100%;
                    padding: 10px;
                }
                .data-point-button {
                    padding: 8px; /* Larger touch targets */
                }
                input[type="number"], input[type="range"] {
                    width: 95%; /* Full width inputs for easier access */
                }
            }
            
            </style>
    </head>
    <body>
        <div class="navbar">
            <b style="margin-right:10px">John Della Rosa</b>| 
            <a href="https://johndellarosa.github.io/">Home</a>|
            <a href="https://johndellarosa.github.io/resume">Resume</a>|
            <a href="https://johndellarosa.github.io/biography">About</a>|
            <a href="https://johndellarosa.github.io/projects">Projects</a>|
            <a href="https://johndellarosa.github.io/miscellaneous">Misc</a>|
            <a href="https://www.linkedin.com/in/johndellarosa/" target="_blank">Linkedin</a>|
            <a href="https://github.com/johndellarosa" target="_blank">Github</a>|
            <a href="https://play.google.com/store/apps/developer?id=JohnDellaRosa" target="_blank">Google Play</a>|
            <a href="https://apps.apple.com/us/developer/john-della-rosa/id1684177615" target="_blank">Apple Store</a>
        
        </div>
        <h2><a href= "table-of-contents.html">Distribution Textbook (Work in Progress)</a></h2>

<h3>by John Della Rosa</h3>
        <div id="text-contents" style="width:90%; margin:auto">
            <div id="Mixture-Distribution-Explanation">
                <h1>Mixture Distributions</h1>
                <h2>Introduction to Mixture Distributions</h2>
                
                <h3>Recommended Prerequesites</h3>
                <ol>
                    <li><a href="https://johndellarosa.github.io/projects/biophysics-book/probability">Probability</a></li>
                    <li><a href="probability-2.html">Probability 2</a></li>
                    <li><a href="./mle.html">Maximum Likelihood Estimation</a></li>


                </ol>
                <h3>Explanation</h3>
                In probability and statistics, a mixture distribution arises when the population being studied is composed of several distinct subpopulations, each of which follows a different probability distribution. Instead of modeling the population as a whole with a single distribution, we assume that the data is generated from one of several component distributions, each with its own characteristics.

                Formally, a mixture distribution represents a probability distribution made up of a weighted combination of other distributions. This should not be confused with the concept of a sum of the realizations of random variables, which is different, but easily mistaken for it; that would be given by convolution. 

                <h3>Definition</h3>
                A mixture distribution is defined as a weighted sum of two or more component distributions. Suppose there are k component distributions 
                \(f_1(x),f_2(x),\dots,f_k(x)\), with weights \(w_1,w_2,\dots,w_k\), where \(w_i\geq 0\) and \(\sum_{i=1}^{k}w_if_i(x)=1\). 
                Then the PDF or PMF of the mixture distribution is given by:

                $$f(x)=\sum_{i=1}^{k}w_if_i(x)$$

                One possible interpretation is that \(w_i\) is the probability of sampling from \(f_i(x)\). 


                <div class="container">
                    <h2>Mixture Distribution Generator</h2>
                    
                    <div class="input-group">
                        <label for="numComponents">Number of Components:</label>
                        <input type="number" id="numComponents" min="1" value="2" inputmode="numeric">
                    </div>
            
                    <div id="componentInputs">
                        <!-- Inputs for distribution components will be dynamically added here -->
                    </div>
            
                    <div class="input-group">
                        <h3>Graph Customization</h3>
                        <div class="axis-settings">
                            <div class="input-field">
                                <label for="xMin">x Min:</label>
                                <input type="number" id="xMin" value="0" inputmode="decimal">
                            </div>
                            <div class="input-field">
                                <label for="xMax">x Max:</label>
                                <input type="number" id="xMax" value="10" inputmode="decimal">
                            </div>
                        </div>
                        <div class="axis-settings">
                            <div class="input-field">
                                <label for="yMin">y Min:</label>
                                <input type="number" id="yMin" value="0" inputmode="decimal">
                            </div>
                            <div class="input-field">
                                <label for="yMax">y Max:</label>
                                <input type="number" id="yMax" value="1" inputmode="decimal">
                            </div>
                        </div>
                    </div>

                    <button id="generate-mixture" >Generate Mixture</button>
                    
                    <canvas id="mixtureChart" width="600" height="400"></canvas>
                </div>
            

                <h3>Sampling from a Mixture Distribution</h3>

                Sampling from a mixture distribution is relatively simple, provided the component distributions are easy to sample from. 
                <h4>Steps</h4>
                <h5>Step 1: Select a Component Based on Weights</h5>
                Select a Component Based on Weights: The first step is to randomly select one of the component distributions according to their weights. This step uses the weights as probabilities, so if a component has a larger weight, it is more likely to be selected.

                You can think of this step as performing a weighted coin flip or drawing from a categorical distribution where each category corresponds to one of the component distributions.
                <br><br>
                Example:
                <ul>
                  <li>Assume you have two components: a normal distribution \(N(\mu_1,\sigma_1^2)\) with weight 0.7 and an exponential distribution \(\text{Exp}(\lambda_2)\) with weight 0.3.</li>
                  <li>Generate a random number u from the uniform distribution U(0,1). If \(u\leq 0.7\), select the normal distribution. Else, select the exponential distribution</li>
                </ul>

                <h5>Step 2: Sample from the Selected Component</h5>
                After selecting a component distribution, the next step is to generate a sample from the chosen distribution.

                <br>
                Example:
                <ul>
                  <li>If you selected the normal distribution in the previous step, sample a value from \(N(\mu_1,\sigma_1^2)\)</li>
                  <li>If you selected the exponential distribution, sample a value from \(\text{Exp}(\lambda_2)\).</li>
                </ul>


                <h4>Pseudocode</h4>
                Here is pseudocode for sampling from a mixture distribution:
                
                <pre><code>
                  Input:
                  - List of component distributions: D1, D2, ..., Dk
                    (Each D represents a different distribution, like normal, exponential, or uniform. These are the components of the mixture.)
                  
                  - List of corresponding weights: w1, w2, ..., wk
                    (The weights determine how likely each component is to be selected. They must sum to 1 so that they form a valid probability distribution.)
                
                Output:
                  - Sampled value from the mixture distribution
                    (This is the final value sampled from one of the component distributions, determined by the weights.)
                
                1. Generate a random number u from U(0, 1)
                   (Generate a uniform random number between 0 and 1. This number will be used to select a component distribution based on the weights. The value of `u` will help simulate the probability of selecting each component.)
                
                2. Use the weights to determine which component distribution to sample from:
                   - Set cumulative_weight = 0
                     (This is an accumulator that will store the running sum of weights. It helps track when the random number `u` falls into a range corresponding to a specific component.)
                   
                   - For each component i from 1 to k:
                     (Iterate through each of the k component distributions.)
                     
                     a. cumulative_weight += wi
                        (Add the weight of the current component `wi` to the cumulative total. This step accumulates the probability mass for each component.)
                
                     b. If u <= cumulative_weight:
                        (Check if the random number `u` falls within the cumulative probability range for the current component.)
                        
                        - Select component Di
                          (If the condition is met, the current component `Di` is selected for sampling, since the random number `u` fell within its weight range.)
                
                        - Break the loop
                          (Exit the loop once a component is selected, as there's no need to check the remaining components.)
                
                3. Sample a value from the selected component distribution
                   (After a component is selected, sample a value from that specific distribution. Each distribution has its own sampling method, such as using the Box-Muller transform for a normal distribution, or inverse transform sampling for an exponential distribution.)
                
                4. Return the sampled value
                   (The function ends by returning the value sampled from the selected component distribution, which represents the final sample from the mixture distribution.)
                
                </code></pre>




                </div>



             




                <div id="Exercises">
                    <h2>Mixture Distribution Practice Problems</h2>
                    <ol>
                      <li>Write code in your preferred language which samples from a mixture distribution that is N(0,1) with weight 0.3 and N(4,2) with weight 0.7.</li> 
                      <li>
                        <strong>Sampling from a Normal-Exponential Mixture Distribution</strong>
                        <p>
                            Consider a mixture distribution with two components:
                            <ul>
                                <li>A normal distribution \( N(0, 1) \) with weight \( 0.6 \)</li>
                                <li>An exponential distribution with rate parameter \( \lambda = 2 \) and weight \( 0.4 \)</li>
                            </ul>
                        </p>
                        <ol type="a">
                            <li>Write the probability density function (PDF) of the mixture distribution.</li>
                            <li>If you were to generate a sample from this mixture distribution, what is the probability that the sample is drawn from the normal distribution?</li>
                            <li>Write a pseudocode algorithm to generate a sample from this mixture distribution.</li>
                        </ol>

                    </li>

                    <li>
                      <strong>Mixture of Uniform Distributions</strong>
                      <p>You are given a mixture of two uniform distributions:</p>
                      <ul>
                          <li>\( U(0, 1) \) with weight \( 0.3 \)</li>
                          <li>\( U(2, 4) \) with weight \( 0.7 \)</li>
                      </ul>
                      <ol type="a">
                          <li>Compute the probability that a randomly sampled value from the mixture is less than 1.</li>
                          <li>Find the cumulative distribution function (CDF) of the mixture distribution.</li>
                          <li>Write a Python function that samples from this mixture distribution.</li>
                      </ol>
                      
                  </li>

                  <li>
                    <strong>Mixture of Three Normal Distributions</strong>
                    <p>Consider a mixture of three normal distributions with the following parameters:</p>
                    <ul>
                        <li>\( N(-1, 0.5^2) \) with weight \( 0.2 \)</li>
                        <li>\( N(2, 1^2) \) with weight \( 0.5 \)</li>
                        <li>\( N(4, 0.25^2) \) with weight \( 0.3 \)</li>
                    </ul>
                    <ol type="a">
                        <li>Derive the expected value \( E[X] \) of the mixture distribution.</li>
                        <li>Derive the variance \( \text{Var}(X) \) of the mixture distribution.</li>
                        <li>Describe the steps to sample from this mixture distribution.</li>
                    </ol>
                    
                </li>
                    </ol>
    
    
                </div>
        </div>
        <script>
            var coll = document.getElementsByClassName("collapsible");
            var i;
    
            for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                content.style.display = "none";
                } else {
                content.style.display = "block";
                }
            });
            } 
            </script>
</body>
</html>
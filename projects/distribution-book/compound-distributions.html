<!DOCTYPE html>
<html lang="en-US">
    <head>

        <meta charset="UTF-8">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2C44LTKBE1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2C44LTKBE1');
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <!-- <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> -->
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
            <title>Compound Distributions</title>
    
        <!-- Meta tags -->
        
        <meta name="keywords" content="Compound distribution">
        <meta name="author" content="John Della Rosa" >
        <meta name="description" content="Introduction to compound distributions.">
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
        <link rel="apple-touch-icon" sizes="180x180" href="https://johndellarosa.github.io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://johndellarosa.github.io/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://johndellarosa.github.io/favicon-16x16.png">
        <link rel="manifest" href="https://johndellarosa.github.io/site.webmanifest">
        <link rel="canonical" href="https://johndellarosa.github.io/projects/distribution-book/compound-distributions"/>    
        <link rel="stylesheet" href="https://johndellarosa.github.io/style.css"> 
<!-- 
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
      

        <script src="../../math.js" type="text/javascript"></script> -->
        <style>
            body {
              font-family: Arial, sans-serif;
              /* background-color: #f5f5f5; */
            }
            
            .container {
              max-width: 1800px;
              width:100%;
              margin: 50px auto;
              padding: 20px;
              background-color: white;
              border-radius: 8px;
              box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
              display: flex;
              flex-direction: column;
              align-items: center;
            }

            /* #chart {
            max-width: 100%;
            height: 600px;
            } */
            
            .input-section, .output-section {
              width: 100%;
              display: flex;
              flex-direction: column;
              align-items: center;
            }
            
            .input-group, #dataPointsList {
              width: 100%;
              margin-bottom: 20px;
              max-width: 500px;
              margin: 0% auto;
              align-items: center;
            }
            
            #dataPointsList button {
                padding:15px;
                margin: 5px;
                background-color: #6CB4EE;
                border-radius: 10px;
            }
            
            #dataPointsList button:hover{
            
              background-color: #6699CC
            
            }
            
            .input-group label {
              display: block;
              font-weight: bold;
              margin-bottom: 5px;
            }
            
            .input-group input, .input-group select, #discreteParams input {
              width: 100%;
              padding: 8px;
              font-size: 14px;
              margin-bottom: 5px;
              border: 1px solid #ccc;
              border-radius: 4px;
            
            }
            
            button {
              padding: 10px 20px;
              font-size: 16px;
              background-color: #28a745;
              color: white;
              border: none;
              border-radius: 4px;
              cursor: pointer;
              transition: background-color 0.3s ease;
            
            }
            
            button:hover {
              background-color: #218838;
            }
            
            input, select {
                margin-bottom:10px;
            }
            
            #compoundChart {
              max-width: 900px;
              /* width:100%; */
            width: 80vw;
            max-height: 40vh;
              /* height: 20%; */
              /* height: 600px; */
              /* max-height: 1000px; */
            }
            
            .output-section {
              display: none;
              width: 100%;
              text-align: center;
            }
            
            h2 {
              margin-bottom: 20px;
            }
            
            h1 {
              text-align: center;
            }
            
            /* Smaller screens (e.g., smartphones) */
            @media (max-width: 600px) {
                .container {
                    width: 100%;
                    padding: 10px;
                }
                .data-point-button {
                    padding: 8px; /* Larger touch targets */
                }
                input[type="number"], input[type="range"] {
                    width: 95%; /* Full width inputs for easier access */
                }
            }
            
            </style>
    </head>
    <body>
        <div class="navbar">
            <b style="margin-right:10px">John Della Rosa</b>| 
            <a href="https://johndellarosa.github.io/">Home</a>|
            <a href="https://johndellarosa.github.io/resume">Resume</a>|
            <a href="https://johndellarosa.github.io/biography">About</a>|
            <a href="https://johndellarosa.github.io/projects">Projects</a>|
            <a href="https://johndellarosa.github.io/miscellaneous">Misc</a>|
            <a href="https://www.linkedin.com/in/johndellarosa/" target="_blank">Linkedin</a>|
            <a href="https://github.com/johndellarosa" target="_blank">Github</a>|
            <a href="https://play.google.com/store/apps/developer?id=JohnDellaRosa" target="_blank">Google Play</a>|
            <a href="https://apps.apple.com/us/developer/john-della-rosa/id1684177615" target="_blank">Apple Store</a>
        
        </div>
        <h2><a href= "table-of-contents.html">Distribution Textbook (Work in Progress)</a></h2>

<h3>by John Della Rosa</h3>
        <div id="text-contents" style="width:90%; margin:auto">
            <div id="Compound-Distribution">
                <h1>Compound Distributions</h1>
                <h2>Introduction to Compound Distributions</h2>
                
                <h3>Recommended Prerequesites</h3>
                <ol>
                    <li><a href="https://johndellarosa.github.io/projects/biophysics-book/probability">Probability</a></li>
                    <li><a href="probability-2.html">Probability 2</a></li>
                    <li><a href="./mle.html">Maximum Likelihood Estimation</a></li>
                    <li><a href="./mixture-distributions.html">Mixture Distributions</a></li>

                </ol>
                
                <h3>Definition</h3>

                In probability and statistics, a compound distribution arises when one random variable is dependent on another. This is often the case when there is an underlying variability in the parameters of a distribution. 
                For example, if we model the number of insurance claims using a Poisson distribution, but the rate of claims (the parameter\(\lambda\)) is itself a random variable, we have a compound Poisson distribution. 
                This is an extension of the idea of conditional distributions. Now, the conditional distributed is conditioned on a random variable. 
                
                <br>



                <h3>An Aside: Common Conditional Probability Rules</h3>

                <h4>Law of Total Probability</h4>

                $$P(A)=\sum_{n}P(A|B_n)P(B_n)$$

                $$P(A)=\int_{-\infty}^{\infty}P(A|X=x)dF_X(x)$$

                $$=\int_{-\infty}^{\infty}P(A|X=x)f_{X}(x)dx$$

                <h4>Law of iterated expectations</h4>

                A useful formula is the law of iterated expectations which relates the unconditional expectation to the conditional expectations. 
                This is essentially an extention of the Law of Total Probability, which becomes apparent if you write out the expectations explicitly. 


                $$\mathbb{E}[X]=\mathbb{E}[\mathbb{E}[X|Y]]$$

                <h4>Law of Total Variance</h4>

                $$\text{Var}(X)=\mathbb{E}[\text{Var}(X|Y)]+\text{Var}(\mathbb{E}[X|Y])$$

                

                <h3>Returning to Defining Compound Distributions</h3>


                A compound distribution is a probability distribution of a random variable \(X\) where the distribution of \(X\) depends on another random variable \(Y\). 
                This can be expressed as

                $$X|Y=z\sim f_{X|Y}(x|y)$$
                where \(X\) has a conditional distribution \(f_X(x|y)\), and \(Y\) follows a marginal distribution \(g_Y(y)\).
                <br><br>
                The unconditional (or marginal) distribution of \(X\) is found by integrating over the distribution of Y:

                $$f_{X}(x)=\int_{-\infty}^{\infty}f_{X|Y}(x|y)g_{Y}(y)dy$$

                The distribution of \(X\) is "compounded" by the randomness of Y.
                This should hopefully look similar to the Law of Total Probability, as it is the same, just restated in probability distribution notation for P(A). 



                </div>


                <div class="container">
                    <h2>Compound Distribution Generator</h2>
            
                    <!-- Primary Distribution Selection -->
                    <div class="input-group">
                        <h3>Primary Distribution (for parameter generation)</h3>
                        <label for="primaryType">Select Primary Distribution:</label>
                        <select id="primaryType" >
                            <option value="gamma">Gamma</option>
                            <option value="normal">Normal</option>
                            <option value="uniform">Uniform</option>
                            <option value="beta">Beta</option>
                            <option value="chiSquared">Chi-Squared</option> 
                        </select>
                        <div id="primaryParams">
                            <!-- Parameters for primary distribution will go here -->
                        </div>
                        <p id="primaryPdfLatex"></p>
                    </div>

                    <!-- Secondary Distribution Selection -->
                    <div class="input-group">
                        <h3>Secondary Distribution (used with generated parameter)</h3>
                        <label for="secondaryType">Select Secondary Distribution:</label>
                        <select id="secondaryType">
                            <option value="poisson">Poisson</option>
                            <option value="exponential">Exponential</option>
                            <option value="normal">Normal</option>
                            <option value="binomial">Binomial</option> 
                            <option value="geometric">Geometric</option> 
                        </select>
                        <div id="secondaryParams">
                            <!-- Parameters for secondary distribution will go here -->
                        </div>
                        <p id="secondaryPdfLatex"></p>
                    </div>
            
                    <button id="generate-button" >Generate Compound Distribution</button>
                    
                    <canvas id="compoundChart" width="600" height="400"></canvas>
                    <div class="input-group">
                        <label for="numSimulations"><strong>Number of Simulations:</strong></label>
                        <input type="number" id="numSimulations" value="1000" min="1" inputmode="decimal">
                    </div>
                    <div class="input-group">
                        <label for="numBins"><strong>Number of Bins:</strong></label>
                        <input type="number" id="numBins" value="50" min="1" inputmode="decimal">
                    </div>
                    
                    <div class="input-group">
                        <label for="xMin"><strong>X-axis Min:</strong></label>
                        <input type="number" id="xMin" placeholder="Auto" inputmode="decimal">
                        <label for="xMax"><strong>X-axis Max:</strong></label>
                        <input type="number" id="xMax" placeholder="Auto" inputmode="decimal">
                    </div>
                    
                    <div class="input-group">
                        <label for="yMin"><strong>Y-axis Min:</strong></label>
                        <input type="number" id="yMin" placeholder="Auto" inputmode="decimal">
                        <label for="yMax"><strong>Y-axis Max:</strong></label>
                        <input type="number" id="yMax" placeholder="Auto" inputmode="decimal">
                    </div>
                    <div id="summaryStats">
                        <h3>Summary Statistics</h3>
                        <p><strong>Mean:</strong> <span id="meanStat"></span></p>
                        <p><strong>Variance:</strong> <span id="varianceStat"></span></p>
                        <p><strong>Standard Deviation:</strong> <span id="stdDevStat"></span></p>
                        <p><strong>Min:</strong> <span id="minStat"></span></p>
                        <p><strong>Max:</strong> <span id="maxStat"></span></p>
                        <p><strong>Skewness:</strong> <span id="skewnessStat"></span></p>
                        <p><strong>Kurtosis:</strong> <span id="kurtosisStat"></span></p>
                    </div>
                    
                    <button id="export-data">Export Data</button>
                </div>
             
                <div id="guide-text">

                    <h3>User Guide</h3>
    <p>
        This tool allows you to generate <strong>compound distributions</strong>, where a parameter is drawn from one distribution (the <strong>primary distribution</strong>) and then used as a parameter for a second distribution (the <strong>secondary distribution</strong>). Follow these steps to use the generator:
    </p>

    <h4>Step 1: Select a Primary Distribution</h4>
    <p>
        The primary distribution generates the parameter for the secondary distribution. You can select from the following:
        <ul>
            <li><strong>Gamma:</strong> Produces positive values. Used for rates or scales. Support: (0, ∞)</li>
            <li><strong>Normal:</strong> Produces both positive and negative values. Support: (-∞, ∞)</li>
            <li><strong>Uniform:</strong> Produces values within a user-specified range. Support: [min, max]</li>
            <li><strong>Beta:</strong> Produces values between 0 and 1. Support: (0, 1)</li>
            <li><strong>Chi-Squared:</strong> Produces positive values. Support: (0, ∞)</li>

        </ul>
    </p>
    <p>
        For each primary distribution, you need to enter specific parameters:
        <ul>
            <li><strong>Gamma:</strong> Enter the shape (k) and rate (θ).</li>
            <li><strong>Normal:</strong> Enter the mean (μ) and variance (σ²).</li>
            <li><strong>Uniform:</strong> Enter the minimum and maximum values.</li>
            <li><strong>Beta:</strong> Enter alpha (α) and beta (β).</li>
            <li><strong>Chi-Squared:</strong> Enter degrees of freedom (k).</li>
        </ul>
        After selecting the primary distribution, the <strong>support</strong> of that distribution will be shown, which indicates the range of possible output values.
    </p>

    <h4>Step 2: Select a Secondary Distribution</h4>
    <p>
        The secondary distribution uses the parameter generated by the primary distribution. Available options include:
        <ul>
            <li><strong>Poisson:</strong> Uses the primary output as the rate (λ). Support: λ must be > 0.</li>
            <li><strong>Exponential:</strong> Uses the primary output as the rate (λ). Support: λ must be > 0.</li>
            <li><strong>Normal:</strong> Uses the primary output as the variance. Support: Variance must be > 0.</li>
            <li><strong>Binomial:</strong> Uses the primary output as the probability (p), with user input for the number of trials (n). Support: p must be between 0 and 1.</li>
            <li><strong>Geometric:</strong> Uses the primary output as the probability (p). Support: p must be between 0 and 1.</li>
       
        </ul>
        When a secondary distribution is selected, any specific requirements for that distribution will be displayed. <strong>It is very important that the output (support) of the first distribution matches the input (valid parameter range) of the second distribution.</strong> 
    </p>

    <h4>Step 3: Generate the Compound Distribution</h4>
    <p>
        After choosing both distributions and entering the parameters, click the "Generate Compound Distribution" button to generate and plot the compound distribution. The tool will automatically validate the inputs and display alerts if any parameter falls outside of its valid range.
    </p>

    <h4>Example Use Case</h4>
    <p>
        Suppose you choose a <strong>Gamma</strong> distribution as the primary with a shape (k) of 2 and a rate (θ) of 2. The tool will generate positive values for λ. If you then choose a <strong>Poisson</strong> distribution as the secondary, the tool will use the λ values generated from the Gamma distribution to produce Poisson samples. You can then visualize the resulting compound distribution.
    </p>

    <h4>Step 5: View Summary Statistics</h4>
    <p>
        After the distribution is generated, you can view <strong>summary statistics</strong> such as:
        <ul>
            <li><strong>Mean:</strong> The average of the generated values.</li>
            <li><strong>Variance:</strong> A measure of the variability in the data.</li>
            <li><strong>Standard Deviation:</strong> The square root of the variance.</li>
            <li><strong>Min and Max:</strong> The minimum and maximum values in the generated sample.</li>
            <li><strong>Skewness:</strong> A measure of the asymmetry of the distribution.</li>
            <li><strong>Kurtosis:</strong> A measure of the "tailedness" of the distribution (excess kurtosis, where normal distribution kurtosis = 0).</li>
        </ul>
    </p>

    <h4>Step 6: Export the Data</h4>
    <p>
        You can export the generated data as a CSV file using the <strong>Export Data</strong> button. This allows you to save the sample for further analysis or reporting.
    </p>
                </div>



                <div id="Exercises">
                    <h2>Compound Distribution Practice Problems</h2>
                    <ol>
                        
                        </ol>
    
    
                </div>
        </div>
        <script src="./compound-funcs.js"></script>
        <script>
            var coll = document.getElementsByClassName("collapsible");
            var i;
    
            for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                content.style.display = "none";
                } else {
                content.style.display = "block";
                }
            });
            } 
            </script>
</body>
</html>
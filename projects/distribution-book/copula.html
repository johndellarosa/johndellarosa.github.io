<!DOCTYPE html>
<html lang="en-US">
    <head>

        <meta charset="UTF-8">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2C44LTKBE1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2C44LTKBE1');
</script>
        <!-- <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> -->
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
            <title>Copulas</title>
    
        <!-- Meta tags -->
        
        <meta name="keywords" content="Copula, Probability Integral Transform">
        <meta name="author" content="John Della Rosa" >
        <meta name="description" content="Introduction to copulas, probability integral transforms, multivariate distributions.">
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
        <link rel="apple-touch-icon" sizes="180x180" href="https://johndellarosa.github.io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://johndellarosa.github.io/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://johndellarosa.github.io/favicon-16x16.png">
        <link rel="manifest" href="https://johndellarosa.github.io/site.webmanifest">
        <link rel="canonical" href="https://johndellarosa.github.io/projects/distribution-book/copula"/>    
        <link rel="stylesheet" href="https://johndellarosa.github.io/style.css"> 
<!-- 
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
      

        <script src="../../math.js" type="text/javascript"></script> -->

    </head>
    <body>
        <div class="navbar">
            <b style="margin-right:10px">John Della Rosa</b>| 
            <a href="https://johndellarosa.github.io/">Home</a>|
            <a href="https://johndellarosa.github.io/resume">Resume</a>|
            <a href="https://johndellarosa.github.io/biography">About</a>|
            <a href="https://johndellarosa.github.io/projects">Projects</a>|
            <a href="https://johndellarosa.github.io/miscellaneous">Misc</a>|
            <a href="https://www.linkedin.com/in/johndellarosa/" target="_blank">Linkedin</a>|
            <a href="https://github.com/johndellarosa" target="_blank">Github</a>|
            <a href="https://play.google.com/store/apps/developer?id=JohnDellaRosa" target="_blank">Google Play</a>|
            <a href="https://apps.apple.com/us/developer/john-della-rosa/id1684177615" target="_blank">Apple Store</a>
        
        </div>
        <h2><a href= "table-of-contents.html">Distribution Textbook (Work in Progress)</a></h2>

<h3>by John Della Rosa</h3>
        <div id="text-contents" style="width:90%; margin:auto">
            <div id="Copulas">
                <h1>Copula</h1>
                <h2>Introduction to Copulas</h2>
                
                <h3>Recommended Prerequesites</h3>
                <ol>
                    <li><a href="https://johndellarosa.github.io/projects/biophysics-book/probability">Probability</a></li>
                    <li><a href="./probability-2.html">Probability II</a></li>
                    <li><a href="./sampling-continuous.html">Sampling</a></li>
                    <li><a href="./multivariate-intro">Introduction to Multivariate Distributions</a></li>
               
                </ol>

                <h3>Probability Integral Transform</h3>

                As a brief aside from multivariate distributions, there is the Probability Integral Transform. 

                <h4>Definition</h4>
                Let \(X\) be a continuous random variable with CDF \(F_X(x)\). The Probability Integral Transform states that the random variable U, given by:

                $$U=F_X(X)$$
                is distributed uniformly over the interval [0,1]; i.e., \(U\sim\mathcal{U}(0,1)\).

                <h4>Multivariate Probability Integral Transform</h4>
                Let \(X=(X_1,X_2,\dots,X_n)\) be a random vector with continuous marginal CDFs \(F_i(x)=P(X_i\lt x)\). 

                By performing the PIT on each element, we get a random vector where each element has U(0,1) marginals:
                $$(U_1,U_2,\dots,U_n)=(F_1(X_1),F_2(X_2),\dots,F_n(X_n))$$

                <h3><a href="./copula-simulator.html">Copula</a></h3>
                Continuing with our random vector \(U\), we define a copula function as:

                $$C(u_1,u_2,\dots,u_n)=P(U_1\leq u_1, U_2\leq u_2,\dots, U_n\leq u_n)$$


                <h3>Gaussian Copula</h3>
                We previously covered how to generated correlated Gaussian variables. We can combine this with our multivariate Probability Integral Transform to get dependent uniforms. 

                <h4>Getting the Copula</h4>
                A corollary to the probability integral transform that we've seen with the quantile function is that given  a variable in the interval (0,1), we can transform it a random variable distributed from a given distribution by applying the inverse CDF. 
                For the Gaussian copula, we apply the normal quantile function to turn our uniform values into normally distributed. If there is a Gaussian copula, then we would see this result distributed as a correlated multivariate normal. 

                <figure>
                    <img src="gaussian-copula.png" alt="Gaussian Copula at different rho" style="margin:auto; display: block;  width:clamp(300px,80vw, 900px)"/>
                    <figcaption>Gaussian Copula at Different Rho</figcaption>
                </figure>

                <h4>Sampling from the Copula</h4>
                Sampling is going the reverse of above. We can generate correlated normals through a multivariate normal distribution. We then apply the marginal CDF to each element to get correlated quantiles. We then apply the quantile function of choice to each element to get them into having marginal distributions of whatever we would like. 

                <h3>T-Copula</h3>
                A similar copula can be performed with heavier tails using the multivariate T-distribution as we did for the Gaussian copula. 

                <figure>
                    <img src="t-copula.png" alt="T at different rho" style="margin:auto; display: block;  width:clamp(300px,80vw, 900px)"/>
                    <figcaption>T Copula at Different Rho</figcaption>
                </figure>



                </div>



             




                <div id="Exercises">
                    <h2>Copula Practice Problems</h2>

                    <ol>
                        <li>Generate pairs of random variables (X,Y) such that:
                            <ol>
                                <li>The marginal distribution of X is exponential with \(\lambda=1\)</li>
                                <li>The marginal distribution of Y is uniform on interval \([0,1]\)</li>
                                <li>The dependence structure between X and Y is given by a Gaussian copula coefficients \(\rho=0.7\)</li>

                            </ol>
                            Output this as a scatter plot. Also output histograms of each marginal.
                        </li>
                        <li>Generate pairs of random variables (X,Y) such that:
                            <ol>
                                <li>The marginal distribution of X is exponential with \(\lambda=2\)</li>
                                <li>The marginal distribution of Y is exponential with \(\lambda=3\)</li>
                                <li>The dependence structure between X and Y is given by a Gaussian copula coefficients \(\rho=-0.3\)</li>

                            </ol>
                            Output this as a scatter plot. Also output histograms of each marginal.
                        </li>


                        <li>Generate pairs of random variables \((X, Y)\) such that: <ol> <li>The marginal distribution of \(X\) is a standard normal distribution.</li> <li>The marginal distribution of \(Y\) follows a Pareto distribution with shape parameter \(\alpha = 2\) and scale parameter \(x_m = 1\).</li> <li>The dependence structure is defined by a Gaussian copula with correlation coefficient \(\rho = -0.5\).</li> </ol> Compute the sample correlation coefficient between \(X\) and \(Y\), and discuss whether it aligns with the specified dependence. </li>
                        <li>Create pairs \((X, Y)\) where: <ol> <li>\(X\) follows a gamma distribution with shape \(k=2\) and scale \(\theta=2\).</li> <li>\(Y\) follows a logistic distribution with location \(m=0\) and scale \(s=1\).</li> <li>The dependence is modeled using a Gaussian copula with correlation coefficient \(\rho = 0.3\).</li> </ol> Simulate 2,000 pairs and plot the histograms of \(X\) and \(Y\) to verify the marginals. Assess the dependence by calculating Kendall's tau and interpret the result. </li> 

                    </ol>
    
    
                </div>
        </div>
        <script>
            var coll = document.getElementsByClassName("collapsible");
            var i;
    
            for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                content.style.display = "none";
                } else {
                content.style.display = "block";
                }
            });
            } 
            </script>
</body>
</html>